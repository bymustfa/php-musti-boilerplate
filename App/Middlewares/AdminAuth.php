<?phpnamespace App\Middlewares;use App\Models\Admins;class AdminAuth{    public function handle()    {        if (!auth()->get('admin_login') && !auth()->get('admin_id')) {            if (isset($_COOKIE["admin_token"])) {                $admin = Admins::where('admin_token', $_COOKIE["admin_token"])->get()->first();                if ($admin) {                    $auth = \Core\Auth::getInstance();                    $auth->create('admin_login', true);                    $auth->create('admin_id', $admin->id);                    $auth->create('admin_token', $admin->admin_token);                    $auth->create('admin_datas', [                        'name' => $admin->admin_name,                        'token' => $admin->admin_token,                        'email' => $admin->admin_email,                        'image' => $admin->admin_image,                        'status' => $admin->admin_status,                        'status_content' => $admin->admin_status_content,                        'security_question_id' => $admin->security_question_id,                        'security_answer' => $admin->security_answer,                    ]);                    return true;                } else {                    header('Location:' . base_url('admin/login'));                    return false;                }            } else {                header('Location:' . base_url('admin/login'));                return false;            }        } elseif (auth()->get('admin_login') && auth()->get('admin_id')) {            return true;        } else {            return false;        }    }    public function NoLogin()    {        if (!auth()->get('admin_login') && !auth()->get('admin_id')) {            return true;        }        return false;    }}?>